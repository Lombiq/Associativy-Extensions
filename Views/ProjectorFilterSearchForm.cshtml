@using Orchard.ContentManagement

@{
    Script.Require("AssociativyFrontends_AutoComplete").AtFoot();
    Style.Require("jQueryUI_Orchard");

    var part = (Associativy.Frontends.Models.Pages.Frontends.AssociativyFrontendSearchFormPart)Model.Model;
    string prefix = Model.Prefix + "_";
    var labelsName = prefix + "Labels";
}

@Html.Hidden(prefix + "IsPartialGraph")
<fieldset>
    @Html.Label(labelsName, T("Search terms").Text)
    @Html.TextBox(labelsName, part.Labels, new { @class = "text textMedium tokenized" })
    @Html.ValidationMessage(labelsName)
</fieldset>

@using (Script.Foot())
{
    <script type="text/javascript">
        (function ($) {
            $(function () {
                var $graphName = $("#GraphName");

                $.associativy.autoComplete.labels("#@labelsName.Replace('.', '_')", "@Url.RouteUrl("Associativy.Frontends.AutoComplete.FetchSimilarLabels")?graphName=" + $graphName.find(":selected").val());

                $graphName.click(function () {
                    $.associativy.autoComplete.labels("#@labelsName.Replace('.', '_')", "@Url.RouteUrl("Associativy.Frontends.AutoComplete.FetchSimilarLabels")?graphName=" + $(this).find(':selected').val());
                });
            });
        })(jQuery);
    </script>
}

@Display.TokenHint()